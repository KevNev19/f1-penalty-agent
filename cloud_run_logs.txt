INFO:     169.254.169.126:33804 - "POST /api/v1/ask HTTP/1.1" 500 Internal Server Error
Traceback (most recent call last):
  File "/app/src/api/routers/chat.py", line 42, in ask_question
    response = agent.ask(normalized_question)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/agent/f1_agent.py", line 216, in ask
    answer = self.llm.generate(prompt, system_prompt=F1_SYSTEM_PROMPT)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/llm/gemini_client.py", line 81, in generate
    response = client.models.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/google/genai/models.py", line 5203, in generate_content
    response = self._generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/google/genai/models.py", line 3985, in _generate_content
    response = self._api_client.request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/google/genai/_api_client.py", line 1388, in request
    response = self._request(http_request, http_options, stream=False)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/google/genai/_api_client.py", line 1224, in _request
    return self._retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/tenacity/__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/tenacity/__init__.py", line 420, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/tenacity/__init__.py", line 187, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.12/site-packages/tenacity/__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/google/genai/_api_client.py", line 1194, in _request_once
    response = self._httpx_client.request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/httpx/_client.py", line 812, in request
    request = self.build_request(
              ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/httpx/_client.py", line 367, in build_request
    headers = self._merge_headers(headers)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/httpx/_client.py", line 430, in _merge_headers
    merged_headers.update(headers)
  File "/usr/local/lib/python3.12/site-packages/httpx/_models.py", line 275, in update
    headers = Headers(headers)
              ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/httpx/_models.py", line 156, in __init__
    bytes_value = _normalize_header_value(v, encoding)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/httpx/_models.py", line 82, in _normalize_header_value
    return value.encode(encoding or "ascii")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'ascii' codec can't encode character '\ufeff' in position 0: ordinal not in range(128)
2025-12-30 01:10:08,099 - src.api.routers.chat - ERROR - UnicodeEncodeError traceback:
2025-12-30 01:10:08,097 - src.llm.gemini_client - ERROR - Gemini error: 'ascii' codec can't encode character '\ufeff' in position 0: ordinal not in range(128)
2025-12-30 01:10:08,096 - google_genai.models - INFO - AFC is enabled with max remote calls: 10.
2025-12-30 01:10:08,075 - httpx - INFO - HTTP Request: POST https://81c9470b-18a4-48a8-ae16-c95b6feb5e80.europe-west3-0.gcp.cloud.qdrant.io:6333/collections/race_data/points/query "HTTP/1.1 200 OK"
2025-12-30 01:10:04,873 - httpx - INFO - HTTP Request: POST https://81c9470b-18a4-48a8-ae16-c95b6feb5e80.europe-west3-0.gcp.cloud.qdrant.io:6333/collections/stewards_decisions/points/query "HTTP/1.1 200 OK"
2025-12-30 01:10:01,724 - httpx - INFO - HTTP Request: POST https://81c9470b-18a4-48a8-ae16-c95b6feb5e80.europe-west3-0.gcp.cloud.qdrant.io:6333/collections/regulations/points/query "HTTP/1.1 200 OK"

INFO:     169.254.169.126:42790 - "POST /api/v1/ask HTTP/1.1" 500 Internal Server Error
Traceback (most recent call last):
  File "/app/src/api/routers/chat.py", line 42, in ask_question
    response = agent.ask(normalized_question)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/agent/f1_agent.py", line 216, in ask
    answer = self.llm.generate(prompt, system_prompt=F1_SYSTEM_PROMPT)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/llm/gemini_client.py", line 81, in generate
    response = client.models.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/google/genai/models.py", line 5203, in generate_content
    response = self._generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/google/genai/models.py", line 3985, in _generate_content
    response = self._api_client.request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/google/genai/_api_client.py", line 1388, in request
    response = self._request(http_request, http_options, stream=False)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/google/genai/_api_client.py", line 1224, in _request
    return self._retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/tenacity/__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/tenacity/__init__.py", line 420, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/tenacity/__init__.py", line 187, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.12/site-packages/tenacity/__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/google/genai/_api_client.py", line 1194, in _request_once
    response = self._httpx_client.request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/httpx/_client.py", line 812, in request
    request = self.build_request(
              ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/httpx/_client.py", line 367, in build_request
    headers = self._merge_headers(headers)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/httpx/_client.py", line 430, in _merge_headers
    merged_headers.update(headers)
  File "/usr/local/lib/python3.12/site-packages/httpx/_models.py", line 275, in update
    headers = Headers(headers)
              ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/httpx/_models.py", line 156, in __init__
    bytes_value = _normalize_header_value(v, encoding)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/httpx/_models.py", line 82, in _normalize_header_value
    return value.encode(encoding or "ascii")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'ascii' codec can't encode character '\ufeff' in position 0: ordinal not in range(128)
2025-12-30 01:04:04,287 - src.api.routers.chat - ERROR - UnicodeEncodeError traceback:
2025-12-30 01:04:04,285 - src.llm.gemini_client - ERROR - Gemini error: 'ascii' codec can't encode character '\ufeff' in position 0: ordinal not in range(128)
2025-12-30 01:04:04,284 - google_genai.models - INFO - AFC is enabled with max remote calls: 10.
2025-12-30 01:04:04,282 - httpx - INFO - HTTP Request: POST https://81c9470b-18a4-48a8-ae16-c95b6feb5e80.europe-west3-0.gcp.cloud.qdrant.io:6333/collections/race_data/points/query "HTTP/1.1 200 OK"
2025-12-30 01:04:01,139 - httpx - INFO - HTTP Request: POST https://81c9470b-18a4-48a8-ae16-c95b6feb5e80.europe-west3-0.gcp.cloud.qdrant.io:6333/collections/stewards_decisions/points/query "HTTP/1.1 200 OK"
2025-12-30 01:03:57,992 - httpx - INFO - HTTP Request: POST https://81c9470b-18a4-48a8-ae16-c95b6feb5e80.europe-west3-0.gcp.cloud.qdrant.io:6333/collections/regulations/points/query "HTTP/1.1 200 OK"

INFO:     169.254.169.126:49904 - "POST /api/v1/ask HTTP/1.1" 500 Internal Server Error
Traceback (most recent call last):
  File "/app/src/api/routers/chat.py", line 42, in ask_question
    response = agent.ask(normalized_question)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/agent/f1_agent.py", line 216, in ask
    answer = self.llm.generate(prompt, system_prompt=F1_SYSTEM_PROMPT)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/llm/gemini_client.py", line 81, in generate
    response = client.models.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/google/genai/models.py", line 5203, in generate_content
    response = self._generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/google/genai/models.py", line 3985, in _generate_content
    response = self._api_client.request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/google/genai/_api_client.py", line 1388, in request
    response = self._request(http_request, http_options, stream=False)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/google/genai/_api_client.py", line 1224, in _request
    return self._retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/tenacity/__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/tenacity/__init__.py", line 420, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/tenacity/__init__.py", line 187, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.12/site-packages/tenacity/__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/google/genai/_api_client.py", line 1194, in _request_once
    response = self._httpx_client.request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/httpx/_client.py", line 812, in request
    request = self.build_request(
              ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/httpx/_client.py", line 367, in build_request
    headers = self._merge_headers(headers)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/httpx/_client.py", line 430, in _merge_headers
    merged_headers.update(headers)
  File "/usr/local/lib/python3.12/site-packages/httpx/_models.py", line 275, in update
    headers = Headers(headers)
              ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/httpx/_models.py", line 156, in __init__
    bytes_value = _normalize_header_value(v, encoding)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/httpx/_models.py", line 82, in _normalize_header_value
    return value.encode(encoding or "ascii")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'ascii' codec can't encode character '\ufeff' in position 0: ordinal not in range(128)
2025-12-30 00:54:23,522 - src.api.routers.chat - ERROR - UnicodeEncodeError traceback:
2025-12-30 00:54:23,521 - src.llm.gemini_client - ERROR - Gemini error: 'ascii' codec can't encode character '\ufeff' in position 0: ordinal not in range(128)
2025-12-30 00:54:23,520 - google_genai.models - INFO - AFC is enabled with max remote calls: 10.
2025-12-30 00:54:23,518 - httpx - INFO - HTTP Request: POST https://81c9470b-18a4-48a8-ae16-c95b6feb5e80.europe-west3-0.gcp.cloud.qdrant.io:6333/collections/race_data/points/query "HTTP/1.1 200 OK"
2025-12-30 00:54:20,383 - httpx - INFO - HTTP Request: POST https://81c9470b-18a4-48a8-ae16-c95b6feb5e80.europe-west3-0.gcp.cloud.qdrant.io:6333/collections/stewards_decisions/points/query "HTTP/1.1 200 OK"
2025-12-30 00:54:17,250 - httpx - INFO - HTTP Request: POST https://81c9470b-18a4-48a8-ae16-c95b6feb5e80.europe-west3-0.gcp.cloud.qdrant.io:6333/collections/regulations/points/query "HTTP/1.1 200 OK"
INFO:     169.254.169.126:9462 - "POST /api/v1/ask HTTP/1.1" 500 Internal Server Error
Traceback (most recent call last):
  File "/app/src/api/routers/chat.py", line 42, in ask_question
    response = agent.ask(normalized_question)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/agent/f1_agent.py", line 216, in ask
    answer = self.llm.generate(prompt, system_prompt=F1_SYSTEM_PROMPT)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/llm/gemini_client.py", line 81, in generate
    response = client.models.generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/google/genai/models.py", line 5203, in generate_content
    response = self._generate_content(
               ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/google/genai/models.py", line 3985, in _generate_content
    response = self._api_client.request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/google/genai/_api_client.py", line 1388, in request
    response = self._request(http_request, http_options, stream=False)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/google/genai/_api_client.py", line 1224, in _request
    return self._retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/tenacity/__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/tenacity/__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/tenacity/__init__.py", line 420, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/tenacity/__init__.py", line 187, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.12/site-packages/tenacity/__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/google/genai/_api_client.py", line 1194, in _request_once
    response = self._httpx_client.request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/httpx/_client.py", line 812, in request
    request = self.build_request(
              ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/httpx/_client.py", line 367, in build_request
    headers = self._merge_headers(headers)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/httpx/_client.py", line 430, in _merge_headers
    merged_headers.update(headers)
  File "/usr/local/lib/python3.12/site-packages/httpx/_models.py", line 275, in update
    headers = Headers(headers)
              ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/httpx/_models.py", line 156, in __init__
    bytes_value = _normalize_header_value(v, encoding)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/httpx/_models.py", line 82, in _normalize_header_value
    return value.encode(encoding or "ascii")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'ascii' codec can't encode character '\ufeff' in position 0: ordinal not in range(128)
2025-12-30 00:54:14,086 - src.api.routers.chat - ERROR - UnicodeEncodeError traceback:
2025-12-30 00:54:14,076 - src.llm.gemini_client - ERROR - Gemini error: 'ascii' codec can't encode character '\ufeff' in position 0: ordinal not in range(128)
